<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving
and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">

<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">

<front>
<journal-meta>
<journal-id></journal-id>

<journal-title-group>
<journal-title>Earth and Space Science</journal-title>
</journal-title-group>
<issn></issn>

<publisher>
<publisher-name></publisher-name>
</publisher>
</journal-meta>


<article-meta>


<title-group>
<article-title>Ajuste da Distribuição Generalizada de Valores Extremos
para a Precipitações Máximas Diárias no Brasil</article-title>
</title-group>

<contrib-group>
<contrib contrib-type="author" corresp="yes">
<name>
<surname>Duval</surname>
<given-names>Tomas</given-names>
</name>
<string-name>Tomas Duval</string-name>

<email>steve@curvenote.com</email>
<role vocab="https://credit.niso.org" vocab-term="investigation" vocab-term-identifier="https://credit.niso.org/contributor-roles/investigation/">Investigation</role>
<role vocab="https://credit.niso.org" vocab-term="project
administration" vocab-term-identifier="https://credit.niso.org/contributor-roles/project-administration/">Project
administration</role>
<role vocab="https://credit.niso.org" vocab-term="software" vocab-term-identifier="https://credit.niso.org/contributor-roles/software/">Software</role>
<role vocab="https://credit.niso.org" vocab-term="visualization" vocab-term-identifier="https://credit.niso.org/contributor-roles/visualization/">Visualization</role>
<xref ref-type="aff" rid="aff-1">a</xref>
<xref ref-type="corresp" rid="cor-1">&#x002A;</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">0000-0002-0760-5497</contrib-id>
<name>
<surname>Souza</surname>
<given-names>Saulo AIres</given-names>
</name>
<string-name>Saulo AIres de Souza</string-name>

<email>steve@curvenote.com</email>
<role vocab="https://credit.niso.org" vocab-term="investigation" vocab-term-identifier="https://credit.niso.org/contributor-roles/investigation/">Investigation</role>
<role vocab="https://credit.niso.org" vocab-term="project
administration" vocab-term-identifier="https://credit.niso.org/contributor-roles/project-administration/">Project
administration</role>
<role vocab="https://credit.niso.org" vocab-term="software" vocab-term-identifier="https://credit.niso.org/contributor-roles/software/">Software</role>
<role vocab="https://credit.niso.org" vocab-term="visualization" vocab-term-identifier="https://credit.niso.org/contributor-roles/visualization/">Visualization</role>
<xref ref-type="aff" rid="aff-2">b</xref>
<xref ref-type="corresp" rid="cor-2">&#x002A;</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">0000-0003-1787-9763</contrib-id>
<name>
<surname>Jr.</surname>
<given-names>Dirceu S. Reis</given-names>
</name>
<string-name>Dirceu S. Reis Jr.</string-name>

<xref ref-type="aff" rid="aff-3">c</xref>
</contrib>
</contrib-group>
<aff id="aff-1">
<institution-wrap>
<institution>Curvenote</institution>
</institution-wrap>







</aff>
<aff id="aff-2">
<institution-wrap>
<institution>Agência Nacinal de Águas e Saneamento Básico -
ANA</institution>
</institution-wrap>







</aff>
<aff id="aff-3">
<institution-wrap>
<institution>Professor, Departamento de Engenharia Civil e Ambinetal,
Universidade de Brasília</institution>
</institution-wrap>







</aff>
<author-notes>
<corresp id="cor-1">steve@curvenote.com</corresp>
<corresp id="cor-2">steve@curvenote.com</corresp>
</author-notes>

<pub-date date-type="pub" publication-format="electronic" iso-8601-date="2024-03-03">
<year>2024</year>
<month>3</month>
<day>3</day>
</pub-date>







<history></history>


<abstract>
<p>In September 2021, a significant jump in seismic activity on the
island of La Palma (Canary Islands, Spain) signaled the start of a
volcanic crisis that still continues at the time of writing. Earthquake
data is continually collected and published by the Instituto Geográphico
Nacional (IGN). …</p>
</abstract>
<kwd-group kwd-group-type="author">
<kwd>Curvas IDF</kwd>
<kwd>Informação regional</kwd>
</kwd-group>




</article-meta>

</front>

<body>
<sec id="dados-empregados">
  <title>1 Dados empregados</title>
  <sec id="leitura-dos-dados">
    <title>1.1 Leitura dos dados</title>
  </sec>
  <sec id="tabela-resumo">
    <title>1.2 Tabela Resumo</title>
    <fig id="tbl-record-length-statistics">
      <caption><p>Table 1: Resumo das estatísticas do tamanho das séries
      históricas das estações Plu por bacia hidrográfica</p></caption>
    </fig>
  </sec>
  <sec id="plotagem-da-estações">
    <title>1.3 Plotagem da estações</title>
    <p>A <xref alt="Figure 1" rid="fig-number-stations">Figure 1</xref>
    apresenta a evolução temporal do número de estações que contém
    valores de precipitação diária máxima anual.</p>
    <fig id="fig-number-stations">
      <caption><p>Figure 1: Número de estações Plu no
      Brasil</p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="index_files/figure-jats/notebooks-explore_daily_precip-fig-number-stations-output-2.png" />
    </fig>
  </sec>
</sec>
<sec id="resultados">
  <title>2 Resultados</title>
  <sec id="estimativa-do-parâmetro-de-forma-kappa">
    <title>2.1 Estimativa do parâmetro de forma
    <inline-formula><alternatives>
    <tex-math><![CDATA[\kappa]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>κ</mml:mi></mml:math></alternatives></inline-formula></title>
  </sec>
</sec>
<sec id="introduction">
  <title>3 Introduction</title>
  <fig id="fig-timeline">
    <caption><p>Figure 2: Timeline of recent earthquakes on La
    Palma</p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="index_files/figure-jats/fig-timeline-1.png" />
  </fig>
  <p>Based on data up to and including 1971, eruptions on La Palma
  happen every 79.8 years on average.</p>
  <p>Studies of the magma systems feeding the volcano, such as Marrero
  et al.
  (<xref alt="2019" rid="ref-marrero2019" ref-type="bibr">2019</xref>),
  have proposed that there are two main magma reservoirs feeding the
  Cumbre Vieja volcano; one in the mantle (30-40km depth) which charges
  and in turn feeds a shallower crustal reservoir (10-20km depth).</p>
  <p>Eight eruptions have been recorded since the late 1400s
  (<xref alt="Figure 2" rid="fig-timeline">Figure 2</xref>).</p>
  <p>Data and methods are discussed in
  <xref alt="Section 4" rid="sec-data-methods">Section 4</xref>.</p>
  <p>Let <inline-formula><alternatives>
  <tex-math><![CDATA[x]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>x</mml:mi></mml:math></alternatives></inline-formula>
  denote the number of eruptions in a year. Then,
  <inline-formula><alternatives>
  <tex-math><![CDATA[x]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>x</mml:mi></mml:math></alternatives></inline-formula>
  can be modeled by a Poisson distribution</p>
  <p><styled-content id="eq-poisson"><disp-formula><alternatives>
  <tex-math><![CDATA[
  p(x) = \frac{e^{-\lambda} \lambda^{x}}{x !}
   \qquad(1)]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>λ</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mi>λ</mml:mi><mml:mi>x</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mi>!</mml:mi></mml:mrow></mml:mfrac><mml:mspace width="2.0em"></mml:mspace><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula></styled-content></p>
  <p>where <inline-formula><alternatives>
  <tex-math><![CDATA[\lambda]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>λ</mml:mi></mml:math></alternatives></inline-formula>
  is the rate of eruptions per year. Using
  <xref alt="Equation 1" rid="eq-poisson">Equation 1</xref>, the
  probability of an eruption in the next <inline-formula><alternatives>
  <tex-math><![CDATA[t]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>t</mml:mi></mml:math></alternatives></inline-formula>
  years can be calculated.</p>
  <fig id="tbl-history">
    <caption><p>Table 2: Recent historic eruptions on La
    Palma</p></caption>
    <table-wrap>
      <table>
        <thead>
          <tr>
            <th>Name</th>
            <th>Year</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Current</td>
            <td>2021</td>
          </tr>
          <tr>
            <td>Teneguía</td>
            <td>1971</td>
          </tr>
          <tr>
            <td>Nambroque</td>
            <td>1949</td>
          </tr>
          <tr>
            <td>El Charco</td>
            <td>1712</td>
          </tr>
          <tr>
            <td>Volcán San Antonio</td>
            <td>1677</td>
          </tr>
          <tr>
            <td>Volcán San Martin</td>
            <td>1646</td>
          </tr>
          <tr>
            <td>Tajuya near El Paso</td>
            <td>1585</td>
          </tr>
          <tr>
            <td>Montaña Quemada</td>
            <td>1492</td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
  </fig>
  <p><xref alt="Table 2" rid="tbl-history">Table 2</xref> summarises the
  eruptions recorded since the colonization of the islands by Europeans
  in the late 1400s.</p>
  <fig id="fig-map">
    <caption><p>Figure 3: Map of La Palma</p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="images/la-palma-map.png" />
  </fig>
  <p>La Palma is one of the west most islands in the Volcanic
  Archipelago of the Canary Islands
  (<xref alt="Figure 3" rid="fig-map">Figure 3</xref>).</p>
  <fig id="fig-spatial-plot">
    <caption><p>Figure 4: Locations of earthquakes on La Palma since
    2017</p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="index_files/figure-jats/notebooks-explore-earthquakes-fig-spatial-plot-output-1.png" />
  </fig>
  <p><xref alt="Figure 4" rid="fig-spatial-plot">Figure 4</xref> shows
  the location of recent Earthquakes on La Palma.</p>
</sec>
<sec id="sec-data-methods">
  <title>4 Data &amp; Methods</title>
</sec>
<sec id="conclusion">
  <title>5 Conclusion</title>
</sec>
</body>

<back>
<ref-list>
  <title>References</title>
  <ref id="ref-marrero2019">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Marrero</surname><given-names>José</given-names></name>
        <name><surname>García</surname><given-names>Alicia</given-names></name>
        <name><surname>Berrocoso</surname><given-names>Manuel</given-names></name>
        <name><surname>Llinares</surname><given-names>Ángeles</given-names></name>
        <name><surname>Rodríguez-Losada</surname><given-names>Antonio</given-names></name>
        <name><surname>Ortiz</surname><given-names>R.</given-names></name>
      </person-group>
      <article-title>Strategies for the development of volcanic hazard maps in monogenetic volcanic fields: The example of La Palma (Canary Islands)</article-title>
      <source>Journal of Applied Volcanology</source>
      <year iso-8601-date="2019-07">2019</year><month>07</month>
      <volume>8</volume>
      <pub-id pub-id-type="doi">10.1186/s13617-019-0085-5</pub-id>
      <fpage></fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
</ref-list>
</back>

<sub-article article-type="notebook" id="nb-12-nb-article">
<front-stub>
<title-group>
<article-title>Ajuste da Distribuição Generalizada de Valores Extremos
para a Precipitações Máximas Diárias no Brasil</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes">
<name>
<surname>Duval</surname>
<given-names>Tomas</given-names>
</name>
<string-name>Tomas Duval</string-name>

<email>steve@curvenote.com</email>
<role vocab="https://credit.niso.org" vocab-term="investigation" vocab-term-identifier="https://credit.niso.org/contributor-roles/investigation/">Investigation</role>
<role vocab="https://credit.niso.org" vocab-term="project
administration" vocab-term-identifier="https://credit.niso.org/contributor-roles/project-administration/">Project
administration</role>
<role vocab="https://credit.niso.org" vocab-term="software" vocab-term-identifier="https://credit.niso.org/contributor-roles/software/">Software</role>
<role vocab="https://credit.niso.org" vocab-term="visualization" vocab-term-identifier="https://credit.niso.org/contributor-roles/visualization/">Visualization</role>
<xref ref-type="aff" rid="aff-1-nb-article">a</xref>
<xref ref-type="corresp" rid="cor-1-nb-article">&#x002A;</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">0000-0002-0760-5497</contrib-id>
<name>
<surname>Souza</surname>
<given-names>Saulo AIres</given-names>
</name>
<string-name>Saulo AIres de Souza</string-name>

<email>steve@curvenote.com</email>
<role vocab="https://credit.niso.org" vocab-term="investigation" vocab-term-identifier="https://credit.niso.org/contributor-roles/investigation/">Investigation</role>
<role vocab="https://credit.niso.org" vocab-term="project
administration" vocab-term-identifier="https://credit.niso.org/contributor-roles/project-administration/">Project
administration</role>
<role vocab="https://credit.niso.org" vocab-term="software" vocab-term-identifier="https://credit.niso.org/contributor-roles/software/">Software</role>
<role vocab="https://credit.niso.org" vocab-term="visualization" vocab-term-identifier="https://credit.niso.org/contributor-roles/visualization/">Visualization</role>
<xref ref-type="aff" rid="aff-2-nb-article">b</xref>
<xref ref-type="corresp" rid="cor-2-nb-article">&#x002A;</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">0000-0003-1787-9763</contrib-id>
<name>
<surname>Jr.</surname>
<given-names>Dirceu S. Reis</given-names>
</name>
<string-name>Dirceu S. Reis Jr.</string-name>

<xref ref-type="aff" rid="aff-3-nb-article">c</xref>
</contrib>
</contrib-group>
<aff id="aff-1-nb-article">
<institution-wrap>
<institution>Curvenote</institution>
</institution-wrap>







</aff>
<aff id="aff-2-nb-article">
<institution-wrap>
<institution>Agência Nacinal de Águas e Saneamento Básico -
ANA</institution>
</institution-wrap>







</aff>
<aff id="aff-3-nb-article">
<institution-wrap>
<institution>Professor, Departamento de Engenharia Civil e Ambinetal,
Universidade de Brasília</institution>
</institution-wrap>







</aff>
<author-notes>
<corresp id="cor-1-nb-article">steve@curvenote.com</corresp>
<corresp id="cor-2-nb-article">steve@curvenote.com</corresp>
</author-notes>
<abstract>
<p>In September 2021, a significant jump in seismic activity on the
island of La Palma (Canary Islands, Spain) signaled the start of a
volcanic crisis that still continues at the time of writing. Earthquake
data is continually collected and published by the Instituto Geográphico
Nacional (IGN). …</p>
</abstract>
</front-stub>

<body>
<sec id="dados-empregados-nb-article">
  <title>1 Dados empregados</title>
  <sec id="leitura-dos-dados-nb-article">
    <title>1.1 Leitura dos dados</title>
  </sec>
  <sec id="tabela-resumo-nb-article">
    <title>1.2 Tabela Resumo</title>
    <sec id="nb-code-cell-1-nb-article" specific-use="notebook-code">
    <code language="python"># Create a display table showing ten of
# the largest islands in the world
gt_tbl &lt;- gt(Tab_resumo_RL,rowname_col = &quot;BaciaCodigo&quot;) %&gt;%
    tab_header(
    title = &quot;Resumo estatístico do tamanho das séries históricas&quot;,
    subtitle = &quot;Informação por bacia hidrográfica&quot;
  ) %&gt;%
  tab_source_note(
    source_note = &quot;Fonte dos dados: Hidroweb da ANA (2023).&quot;
  ) %&gt;%
   tab_stubhead(label = &quot;Bacia&quot;) %&gt;%
  tab_spanner(
    label = &quot;Tamanho da série (n)&quot;,
    columns = c(min, Q10, Q25, median, Q75, Q90, max, media)
  ) %&gt;%
   cols_label(
    Q10 = html(&quot;n&lt;sub&gt;10&lt;/sub&gt;&quot;),
    Q25 = html(&quot;n&lt;sub&gt;25&lt;/sub&gt;&quot;),
    median = html(&quot;n&lt;sub&gt;median&lt;/sub&gt;&quot;),
    Q75 = html(&quot;n&lt;sub&gt;75&lt;/sub&gt;&quot;),
    Q90 = html(&quot;n&lt;sub&gt;90&lt;/sub&gt;&quot;)
   )
    
    
# Show the gt Table
gt_tbl</code>
    <fig id="tbl-record-length-statistics-nb-article">
      <caption><p>Table 1: Resumo das estatísticas do tamanho das séries
      históricas das estações Plu por bacia hidrográfica</p></caption>
      <sec id="nb-code-cell-1-output-0-nb-article" specific-use="notebook-output">
      </sec>
    </fig>
    </sec>
  </sec>
  <sec id="plotagem-da-estações-nb-article">
    <title>1.3 Plotagem da estações</title>
    <p>A <xref alt="Figure 1" rid="fig-number-stations-nb-article">Figure 1</xref>
    apresenta a evolução temporal do número de estações que contém
    valores de precipitação diária máxima anual.</p>
    <sec id="cell-fig-number-stations-nb-article" specific-use="notebook-code">
    <code language="python"># Criação de plotagem do número de estações com valores diários de precipitação
# ao longo dos anos.

ggplot() +
  geom_line(data = n_stations_year,aes(Ano,n),colour = 'black', linewidth = 1) +
   labs(title = &quot;Chuva Máxima Diária no Brasil&quot;, subtitle = &quot;Número de estações&quot;,
       caption = &quot;fonte dos dados: ANA (2022)&quot;,
       x = &quot;Datas&quot;, y = &quot;Estações&quot;) +
  theme_bw()</code>
    <sec id="cell-fig-number-stations-output-0-nb-article" specific-use="notebook-output">
    <preformat>Warning: Ignoring unknown parameters: linewidth</preformat>
    </sec>
    <sec id="cell-fig-number-stations-output-1-nb-article" specific-use="notebook-output">
    <fig id="fig-number-stations-nb-article">
      <caption><p>Figure 1: Número de estações Plu no
      Brasil</p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="index_files/figure-jats/notebooks-explore_daily_precip-fig-number-stations-output-2.png" />
    </fig>
    </sec>
    </sec>
  </sec>
</sec>
<sec id="resultados-nb-article">
  <title>2 Resultados</title>
  <sec id="estimativa-do-parâmetro-de-forma-kappa-nb-article">
    <title>2.1 Estimativa do parâmetro de forma
    <inline-formula><alternatives>
    <tex-math><![CDATA[\kappa]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>κ</mml:mi></mml:math></alternatives></inline-formula></title>
  </sec>
</sec>
<sec id="introduction-nb-article">
  <title>3 Introduction</title>
  <sec id="nb-code-cell-2-nb-article" specific-use="notebook-code">
  <code language="r script">eruptions &lt;- c(1492, 1585, 1646, 1677, 1712, 1949, 1971, 2021)
n_eruptions &lt;- length(eruptions)</code>
  </sec>
  <sec id="cell-fig-timeline-nb-article" specific-use="notebook-code">
  <code language="r script">par(mar = c(3, 1, 1, 1) + 0.1)
plot(eruptions, rep(0, n_eruptions), 
  pch = &quot;|&quot;, axes = FALSE)
axis(1)
box()</code>
  <fig id="fig-timeline-nb-article">
    <caption><p>Figure 2: Timeline of recent earthquakes on La
    Palma</p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="index_files/figure-jats/fig-timeline-1.png" />
  </fig>
  </sec>
  <sec id="nb-code-cell-3-nb-article" specific-use="notebook-code">
  <code language="r script">avg_years_between_eruptions &lt;- mean(diff(eruptions[-n_eruptions]))
avg_years_between_eruptions</code>
  <sec id="nb-code-cell-3-output-0-nb-article" specific-use="notebook-output">
  <preformat>[1] 79.83333</preformat>
  </sec>
  </sec>
  <p>Based on data up to and including 1971, eruptions on La Palma
  happen every 79.8 years on average.</p>
  <p>Studies of the magma systems feeding the volcano, such as Marrero
  et al.
  (<xref alt="2019" rid="ref-marrero2019-nb-article" ref-type="bibr">2019</xref>),
  have proposed that there are two main magma reservoirs feeding the
  Cumbre Vieja volcano; one in the mantle (30-40km depth) which charges
  and in turn feeds a shallower crustal reservoir (10-20km depth).</p>
  <p>Eight eruptions have been recorded since the late 1400s
  (<xref alt="Figure 2" rid="fig-timeline-nb-article">Figure 2</xref>).</p>
  <p>Data and methods are discussed in
  <xref alt="Section 4" rid="sec-data-methods-nb-article">Section 4</xref>.</p>
  <p>Let <inline-formula><alternatives>
  <tex-math><![CDATA[x]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>x</mml:mi></mml:math></alternatives></inline-formula>
  denote the number of eruptions in a year. Then,
  <inline-formula><alternatives>
  <tex-math><![CDATA[x]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>x</mml:mi></mml:math></alternatives></inline-formula>
  can be modeled by a Poisson distribution</p>
  <p><styled-content id="eq-poisson-nb-article"><disp-formula><alternatives>
  <tex-math><![CDATA[
  p(x) = \frac{e^{-\lambda} \lambda^{x}}{x !}
   \qquad(1)]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>λ</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mi>λ</mml:mi><mml:mi>x</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mi>!</mml:mi></mml:mrow></mml:mfrac><mml:mspace width="2.0em"></mml:mspace><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula></styled-content></p>
  <p>where <inline-formula><alternatives>
  <tex-math><![CDATA[\lambda]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>λ</mml:mi></mml:math></alternatives></inline-formula>
  is the rate of eruptions per year. Using
  <xref alt="Equation 1" rid="eq-poisson-nb-article">Equation 1</xref>, the
  probability of an eruption in the next <inline-formula><alternatives>
  <tex-math><![CDATA[t]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>t</mml:mi></mml:math></alternatives></inline-formula>
  years can be calculated.</p>
  <fig id="tbl-history-nb-article">
    <caption><p>Table 2: Recent historic eruptions on La
    Palma</p></caption>
    <table-wrap>
      <table>
        <thead>
          <tr>
            <th>Name</th>
            <th>Year</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Current</td>
            <td>2021</td>
          </tr>
          <tr>
            <td>Teneguía</td>
            <td>1971</td>
          </tr>
          <tr>
            <td>Nambroque</td>
            <td>1949</td>
          </tr>
          <tr>
            <td>El Charco</td>
            <td>1712</td>
          </tr>
          <tr>
            <td>Volcán San Antonio</td>
            <td>1677</td>
          </tr>
          <tr>
            <td>Volcán San Martin</td>
            <td>1646</td>
          </tr>
          <tr>
            <td>Tajuya near El Paso</td>
            <td>1585</td>
          </tr>
          <tr>
            <td>Montaña Quemada</td>
            <td>1492</td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
  </fig>
  <p><xref alt="Table 2" rid="tbl-history-nb-article">Table 2</xref> summarises the
  eruptions recorded since the colonization of the islands by Europeans
  in the late 1400s.</p>
  <fig id="fig-map-nb-article">
    <caption><p>Figure 3: Map of La Palma</p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="images/la-palma-map.png" />
  </fig>
  <p>La Palma is one of the west most islands in the Volcanic
  Archipelago of the Canary Islands
  (<xref alt="Figure 3" rid="fig-map-nb-article">Figure 3</xref>).</p>
  <sec id="cell-fig-spatial-plot-nb-article" specific-use="notebook-code">
  <code language="python">la_palma |&gt; 
  ggplot(aes(Longitude, Latitude)) +
  geom_point(aes(color = Magnitude, size = 40-`Depth(km)`)) +
  scale_color_viridis_c(direction = -1) + 
  scale_size(range = c(0.5, 2), guide = &quot;none&quot;) +
  theme_bw()</code>
  <sec id="cell-fig-spatial-plot-output-0-nb-article" specific-use="notebook-output">
  <fig id="fig-spatial-plot-nb-article">
    <caption><p>Figure 4: Locations of earthquakes on La Palma since
    2017</p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="index_files/figure-jats/notebooks-explore-earthquakes-fig-spatial-plot-output-1.png" />
  </fig>
  </sec>
  </sec>
  <p><xref alt="Figure 4" rid="fig-spatial-plot-nb-article">Figure 4</xref> shows
  the location of recent Earthquakes on La Palma.</p>
</sec>
<sec id="sec-data-methods-nb-article">
  <title>4 Data &amp; Methods</title>
</sec>
<sec id="conclusion-nb-article">
  <title>5 Conclusion</title>
</sec>
</body>



<back>
<ref-list>
  <title>References</title>
  <ref id="ref-marrero2019-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Marrero</surname><given-names>José</given-names></name>
        <name><surname>García</surname><given-names>Alicia</given-names></name>
        <name><surname>Berrocoso</surname><given-names>Manuel</given-names></name>
        <name><surname>Llinares</surname><given-names>Ángeles</given-names></name>
        <name><surname>Rodríguez-Losada</surname><given-names>Antonio</given-names></name>
        <name><surname>Ortiz</surname><given-names>R.</given-names></name>
      </person-group>
      <article-title>Strategies for the development of volcanic hazard maps in monogenetic volcanic fields: The example of La Palma (Canary Islands)</article-title>
      <source>Journal of Applied Volcanology</source>
      <year iso-8601-date="2019-07">2019</year><month>07</month>
      <volume>8</volume>
      <pub-id pub-id-type="doi">10.1186/s13617-019-0085-5</pub-id>
      <fpage></fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
</ref-list>
</back>


</sub-article>
<sub-article article-type="notebook" id="nb-4-nb-1">
<front-stub>
<title-group>
<article-title>Explore Annual Maximum daily Precipitation in
Brazil</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>defined</surname>
<given-names>To</given-names>
</name>
<string-name>To be defined</string-name>

</contrib>
</contrib-group>
</front-stub>

<body>
<sec id="nb-code-cell-1-nb-1" specific-use="notebook-code">
<code language="r script">
library(tidyverse)
</code>
<code language="r script">
library(lubridate)
</code>
<code language="r script">
library(gt)
</code>
<code language="r script">
require(knitr)
</code>
<sec id="nb-code-cell-1-output-0-nb-1" specific-use="notebook-output">
<preformat>Warning: package 'tidyverse' was built under R version 4.2.2</preformat>
</sec>
<sec id="nb-code-cell-1-output-1-nb-1" specific-use="notebook-output">
<preformat>── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──
✔ ggplot2 3.3.6     ✔ purrr   0.3.4
✔ tibble  3.1.7     ✔ dplyr   1.0.9
✔ tidyr   1.2.0     ✔ stringr 1.4.0
✔ readr   2.1.2     ✔ forcats 0.5.1
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()</preformat>
</sec>
<sec id="nb-code-cell-1-output-2-nb-1" specific-use="notebook-output">
<preformat>Warning: package 'lubridate' was built under R version 4.2.1</preformat>
</sec>
<sec id="nb-code-cell-1-output-3-nb-1" specific-use="notebook-output">
<preformat>
Attaching package: 'lubridate'

The following objects are masked from 'package:base':

    date, intersect, setdiff, union</preformat>
</sec>
<sec id="nb-code-cell-1-output-4-nb-1" specific-use="notebook-output">
<preformat>Warning: package 'gt' was built under R version 4.2.1</preformat>
</sec>
<sec id="nb-code-cell-1-output-5-nb-1" specific-use="notebook-output">
<preformat>Carregando pacotes exigidos: knitr</preformat>
</sec>
</sec>
<p>O código abaixo lê o arquivo original gerado pelo Eng. Saulo Aires de
Souza, que contém os valores das precipitações máximas diárias e
respectivos anos. Esse código só deve ser gerado de novo caso um novo
arquivo original seja atualizado. Caso contrário, deve-se utilizar o
arquivo RDS contido no diretório.</p>
<sec id="nb-code-cell-2-nb-1" specific-use="notebook-code">
<code language="r script"># Code written by Thiago Lappicy with comments by Dirceu Reis

# Extract metadata only (first 15 lines)
Pd_metadata &lt;-
  read.csv(&quot;DADOS_CONV_SAULO.dat&quot;, header = FALSE, sep = &quot;;&quot;,
           nrows = 15, dec = &quot;.&quot;,na.strings = &quot;null&quot;,
           fileEncoding = &quot;latin1&quot;) #,
           #colClasses = c(&quot;integer&quot;,
          #                &quot;integer&quot;,&quot;integer&quot;,&quot;numeric&quot;,
           #               &quot;numeric&quot;, &quot;numeric&quot;,&quot;numeric&quot;,
            #              &quot;integer&quot;,&quot;char&quot;,&quot;char&quot;,
             #             &quot;char&quot;,&quot;char&quot;,&quot;char&quot;,
              #            &quot;char&quot;,&quot;char&quot;))

# Extract Dates and Annual Maximum Daily Precipitation (20th to 112nd lines)
Pd_tmp &lt;-
  read.csv(&quot;DADOS_CONV_SAULO.dat&quot;, header = TRUE, sep = &quot;;&quot;,
           skip = 20, dec = &quot;.&quot;, na.strings = &quot;null&quot;)

# Create an empty dataframe with the correct columns
Pd &lt;- as.data.frame(matrix(data = NA, nrow = 0, ncol = 17))   

# Name the columns
colnames(Pd) &lt;- c(&quot;Date&quot;, &quot;Pdmax&quot;, Pd_metadata[,1])

# Combine both dataframes with only one column for &quot;Data&quot; and one for &quot;Pdmax&quot;
# Obs: the original file contains one column in excess. That is why we use 
# &quot;to = ncol(Pd_metadata) - 1&quot; in the function &quot;seq&quot; below

for(i in seq(from = 1, to = ncol(Pd_metadata) - 1, by = 2)){
  
  # Printar uma mensagem a cada 500 estações pra ter certeza que ta rodando
  if((i+1) %% 500 == 0) cat(&quot;Rodando iteração: &quot;, i+1, &quot;...\n&quot;)
  
  # Include the metadata contained in Pd_metadata
  # Get only the second column of station &quot;i&quot; and transpose the whole column
  # so it becomes a line with metadata
  metadata_proxy &lt;- as.data.frame(t(Pd_metadata[,(i+1)])) 
  # Copy metadata to all possible observations (max.number.observations = 112)
  metadata_proxy[1:112,] &lt;- metadata_proxy
  # Name the column
  colnames(metadata_proxy) &lt;- Pd_metadata[,1]
  
  # Include the annual maximum daily Precip and Date (Date + Pdmax + Metadata)
  Pd[(nrow(Pd)+1):(nrow(Pd)+nrow(Pd_tmp)),] &lt;-
    cbind(Pd_tmp[,c(i, i+1)], metadata_proxy)
  
}


# Zerar as linhas que tem valores NAs de Data E valor (2 terços +-)
# 425600 pra 156529
Pd &lt;- Pd[-which(is.na(Pd$Pdmax) &amp; is.na(Pd$Date)),]

Pd &lt;- Pd %&gt;%
    mutate( Date = as.Date(Date,&quot;%d/%m/%Y&quot;),
            BaciaCodigo = as.integer(BaciaCodigo),
            SubBaciaCodigo = as.integer(SubBaciaCodigo),
            Estacao_codigo = as.integer(Estacao_codigo),
            Latitude = as.numeric(Latitude),
            Longitude = as.numeric(Longitude),
            Altitude = as.numeric(Altitude))



saveRDS(Pd, &quot;Pd.rds&quot;)

rm(metadata_proxy)
rm(Pd_metadata)
rm(Pd_tmp)
</code>
</sec>
<sec id="nb-code-cell-3-nb-1" specific-use="notebook-code">
<code language="r script">
# Load the data
Pd &lt;- readRDS(&quot;Pd.rds&quot;)

# Create a new column with the year of the observation right after the date
Pd &lt;- Pd %&gt;% mutate(Ano = year(Date), .after = Date)

n_stations_year &lt;- Pd %&gt;% 
  count(Ano)

n_stations_year_bacia &lt;- Pd %&gt;% 
  count(Ano,BaciaCodigo)

record_length_station &lt;- Pd %&gt;% #select(c(4,6:8)) %&gt;%
  group_by(Estacao_codigo,BaciaCodigo) %&gt;%
  summarise(n = n())
</code>
<code language="r script">
Tab_resumo_RL &lt;- record_length_station %&gt;%
  group_by(BaciaCodigo) %&gt;%
  summarise(min = min(n),
            Q10 = floor(quantile(n,probs = 0.10)),
            Q25 = floor(quantile(n,probs = 0.25)),
            median = quantile(n,probs = 0.50),
            Q75 = floor(quantile(n,probs = 0.75)),
            Q90 = floor(quantile(n,probs = 0.90)),
            max = max(n),
            media = mean(n))
</code>
<sec id="nb-code-cell-3-output-0-nb-1" specific-use="notebook-output">
<preformat>`summarise()` has grouped output by 'Estacao_codigo'. You can override using
the `.groups` argument.</preformat>
</sec>
</sec>
<p>Criando uma Tabela para o resumo do tamanho das séries</p>
<sec id="nb-code-cell-4-nb-1" specific-use="notebook-code">
<code language="r script">
# Create a display table showing ten of
# the largest islands in the world
gt_tbl &lt;- gt(Tab_resumo_RL,rowname_col = &quot;BaciaCodigo&quot;) %&gt;%
    tab_header(
    title = &quot;Resumo estatístico do tamanho das séries históricas&quot;,
    subtitle = &quot;Informação por bacia hidrográfica&quot;
  ) %&gt;%
  tab_source_note(
    source_note = &quot;Fonte dos dados: Hidroweb da ANA (2023).&quot;
  ) %&gt;%
   tab_stubhead(label = &quot;Bacia&quot;) %&gt;%
  tab_spanner(
    label = &quot;Tamanho da série (n)&quot;,
    columns = c(min, Q10, Q25, median, Q75, Q90, max, media)
  ) %&gt;%
   cols_label(
    Q10 = html(&quot;n&lt;sub&gt;10&lt;/sub&gt;&quot;),
    Q25 = html(&quot;n&lt;sub&gt;25&lt;/sub&gt;&quot;),
    median = html(&quot;n&lt;sub&gt;median&lt;/sub&gt;&quot;),
    Q75 = html(&quot;n&lt;sub&gt;75&lt;/sub&gt;&quot;),
    Q90 = html(&quot;n&lt;sub&gt;90&lt;/sub&gt;&quot;)
   )
    
    
# Show the gt Table
gt_tbl
</code>
<fig id="tbl-record-length-statistics-nb-1">
  <caption><p>Resumo das estatísticas do tamanho das séries históricas
  das estações Plu por bacia hidrográfica</p></caption>
</fig>
</sec>
<sec id="cell-fig-number-stations-nb-1" specific-use="notebook-code">
<code language="r script">
# Criação de plotagem do número de estações com valores diários de precipitação
# ao longo dos anos.

ggplot() +
  geom_line(data = n_stations_year,aes(Ano,n),colour = 'black', linewidth = 1) +
   labs(title = &quot;Chuva Máxima Diária no Brasil&quot;, subtitle = &quot;Número de estações&quot;,
       caption = &quot;fonte dos dados: ANA (2022)&quot;,
       x = &quot;Datas&quot;, y = &quot;Estações&quot;) +
  theme_bw()
</code>
<fig id="fig-number-stations-nb-1">
  <caption><p>Número de estações Plu no Brasil</p></caption>
  <graphic mimetype="image" mime-subtype="png" xlink:href="explore_daily_precip_files/figure-jats/fig-number-stations-1.png" />
</fig>
<sec id="cell-fig-number-stations-output-0-nb-1" specific-use="notebook-output">
<preformat>Warning: Ignoring unknown parameters: linewidth</preformat>
</sec>
</sec>
<sec id="cell-fig-number-stations-bacia-nb-1" specific-use="notebook-code">
<code language="r script">
# Criação de plotagem do número de estações, por bacia hidrográfica, com valores
# diários de precipitação ao longo dos anos.

ggplot() +
  geom_line(data = n_stations_year_bacia,aes(Ano,n,col = BaciaCodigo), linewidth = 1) +
   labs(title = &quot;Chuva Máxima Diária no Brasil&quot;, subtitle = &quot;Número de estações por bacia&quot;,
       caption = &quot;fonte dos dados: ANA (2022)&quot;,
       x = &quot;Datas&quot;, y = &quot;Estações&quot;, col = &quot;Bacia&quot;) +
  theme_bw()
</code>
<fig id="fig-number-stations-bacia-nb-1">
  <caption><p>Número de estações Plu no Brasil por Bacia</p></caption>
  <graphic mimetype="image" mime-subtype="png" xlink:href="explore_daily_precip_files/figure-jats/fig-number-stations-bacia-1.png" />
</fig>
<sec id="cell-fig-number-stations-bacia-output-0-nb-1" specific-use="notebook-output">
<preformat>Warning: Ignoring unknown parameters: linewidth</preformat>
</sec>
</sec>
<sec id="cell-fig-cdf_record-length-nb-1" specific-use="notebook-code">
<code language="r script">
# Criação de plotagem do número de estações, por bacia hidrográfica, com valores
# diários de precipitação ao longo dos anos.

ggplot() +
  geom_line(data = n_stations_year_bacia,aes(Ano,n,col = BaciaCodigo), size = 1) +
   labs(title = &quot;Chuva Máxima Diária no Brasil&quot;, subtitle = &quot;Número de estações por bacia&quot;,
       caption = &quot;fonte dos dados: ANA (2022)&quot;,
       x = &quot;Datas&quot;, y = &quot;Estações&quot;, col = &quot;Bacia&quot;) +
  theme_bw()
</code>
<fig id="fig-cdf_record-length-nb-1">
  <caption><p>Distribuição de probabilidades acumuladas do tamanho de
  séries históricas das estações pluviométricas no Brasil</p></caption>
  <graphic mimetype="image" mime-subtype="png" xlink:href="explore_daily_precip_files/figure-jats/fig-cdf_record-length-1.png" />
</fig>
</sec>
</body>



<back>
</back>


</sub-article>
<sub-article article-type="notebook" id="nb-8-nb-2">
<front-stub>
<title-group>
<article-title>Explore Earthquakes</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Wickham</surname>
<given-names>Charlotte</given-names>
</name>
<string-name>Charlotte Wickham</string-name>

</contrib>
</contrib-group>
</front-stub>

<body>
<sec id="nb-code-cell-1-nb-2" specific-use="notebook-code">
<code language="r script">library(tidyverse)
</code>
<sec id="nb-code-cell-1-output-0-nb-2" specific-use="notebook-output">
<preformat>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.3     ✔ readr     2.1.4
✔ forcats   1.0.0     ✔ stringr   1.5.0
✔ ggplot2   3.4.3     ✔ tibble    3.2.1
✔ lubridate 1.9.2     ✔ tidyr     1.3.0
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</preformat>
</sec>
</sec>
<p>Read a clean version of data:</p>
<sec id="nb-code-cell-2-nb-2" specific-use="notebook-code">
<code language="r script">la_palma &lt;- read_csv(&quot;la-palma.csv&quot;)
</code>
<sec id="nb-code-cell-2-output-0-nb-2" specific-use="notebook-output">
<preformat>Rows: 11347 Columns: 5
── Column specification ────────────────────────────────────────────────────────
Delimiter: &quot;,&quot;
dbl  (4): Longitude, Latitude, Depth(km), Magnitude
dttm (1): DateTime

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</preformat>
</sec>
</sec>
<p>Create spatial plot:</p>
<sec id="cell-fig-spatial-plot-nb-2" specific-use="notebook-code">
<code language="r script">#|   against longitude.&quot;
la_palma |&gt; 
  ggplot(aes(Longitude, Latitude)) +
  geom_point(aes(color = Magnitude, size = 40-`Depth(km)`)) +
  scale_color_viridis_c(direction = -1) + 
  scale_size(range = c(0.5, 2), guide = &quot;none&quot;) +
  theme_bw()
</code>
<fig id="fig-spatial-plot-nb-2">
  <caption><p>Locations of earthquakes on La Palma since
  2017</p></caption>
  <graphic mimetype="image" mime-subtype="png" xlink:href="explore-earthquakes_files/figure-jats/fig-spatial-plot-1.png" />
</fig>
</sec>
</body>



<back>
</back>


</sub-article>

</article>